{% extends 'base.html' %}
{% load static %}
{% block content %}

<div class="container mt-4">
  <div class="page-inner">
    <h3 class="fw-bold mb-3">Disposal Charts</h3>
    <div class="page-category mb-4">
      Visual overview of disposed IT equipment per category.
    </div>

    <div class="row">
      {% for item in chart_data %}
      <div class="col-md-6 mb-4">
        <div class="card">
          <div class="card-header">
            <div class="card-title">{{ item.label }} Disposal Trend</div>
          </div>
          <div class="card-body">
            <div class="chart-container" style="height: 300px;">
              <canvas id="chart-{{ item.label }}"></canvas>
            </div>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
</div>

<!-- JS dependencies -->
<script src="{% static 'js/plugin/chart.js/chart.min.js' %}"></script>

<script>
  const chartData = {{ chart_data|safe }};

  // Match exact labels from your Python/Django chart_data
  const colors = {
    "Monitor": "#1d7af3",   // Blue
    "Keyboard": "#59d05d", // Green
    "Mouse": "#f3545d",    // Red
    "UPS": "#fdaf4b"       // Orange
  };

  chartData.forEach(item => {
    const color = colors[item.label] || "#1d7af3"; // fallback blue
    const ctx = document.getElementById(`chart-${item.label}`).getContext('2d');

    new Chart(ctx, {
      type: "line",
      data: {
        labels: item.labels,
        datasets: [{
          label: `${item.label} Disposed`,
          borderColor: color,
          pointBorderColor: "#FFF",
          pointBackgroundColor: color,
          pointBorderWidth: 2,
          pointHoverRadius: 4,
          pointHoverBorderWidth: 1,
          pointRadius: 4,
          backgroundColor: "transparent",
          fill: true,
          borderWidth: 2,
          data: item.data,
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        plugins: {
          legend: { position: "bottom" },
          tooltip: {
            mode: "nearest",
            intersect: false,
            padding: 10,
          }
        },
        layout: {
          padding: { left: 15, right: 15, top: 15, bottom: 15 },
        },
        scales: {
          x: {
            ticks: { color: "rgba(0,0,0,0.5)" },
            grid: { zeroLineColor: "transparent" },
          },
          y: {
            beginAtZero: true,
            ticks: { color: "rgba(0,0,0,0.5)" },
            grid: { drawTicks: false },
          }
        }
      }
    });
  });
</script>

{% endblock %}
