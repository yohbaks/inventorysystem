{% extends 'base.html' %}

{% block content %}
<div class="container">
  <div class="page-inner">
    <div class="row">
      <!-- Left Column -->
      <div class="col-md-8">
        <!-- Card for Desktop Details -->
        <div class="card card-round">
          <div class="card-header">
            <div class="card-head-row">
              <div class="card-title">Desktop Package Details</div>
              <div class="card-tools">
                <!-- Button to trigger the modal -->
                <button class="btn btn-label-danger btn-round btn-sm me-2" data-bs-toggle="modal" data-bs-target="#disposeModal">
                  <span class="btn-label">
                    <i class="fa fa-location-arrow"></i>
                  </span>
                  Return to Supply
                </button>
                <!-- Other buttons -->
                <a href="#" class="btn btn-label-success btn-round btn-sm me-2">
                  <span class="btn-label">
                    <i class="fa fa-pencil"></i>
                  </span>
                  Export
                </a>
                <a href="#" class="btn btn-label-info btn-round btn-sm">
                  <span class="btn-label">
                    <i class="fa fa-print"></i>
                  </span>
                  Print
                </a>
              </div>
            </div>
          </div>
          <div class="card-body">

            <div class="container">
              <h2>R08-LEY4-156</h2>
              {% comment %} this is the message if successfull updsated {% endcomment %}
              {% if messages %}
                {% for message in messages %}
                  <div class="alert alert-{{ message.tags }}">
                      {{ message }}
                  </div>
               {% endfor %}
              {% endif %}
              <div class="card-body">
                <!-- Navigation Pills -->
                <ul class="nav nav-pills nav-secondary nav-pills-no-bd nav-pills-icons justify-content-center" id="pills-tab-with-icon" role="tablist">
                  <li class="nav-item submenu" role="presentation">
                    <a class="nav-link active" id="pills-desktop-tab" data-bs-toggle="pill" href="#pills-desktop" role="tab" aria-controls="pills-desktop" aria-selected="true">
                      <i class="fas fa-desktop"></i>
                      Desktop Details
                    </a>
                  </li>
                  <li class="nav-item submenu" role="presentation">
                    <a class="nav-link" id="pills-monitor-tab" data-bs-toggle="pill" href="#pills-monitor" role="tab" aria-controls="pills-monitor" aria-selected="false" tabindex="-1">
                      <i class="fas fa-tv"></i>
                      Monitor Details
                    </a>
                  </li>
                  <li class="nav-item submenu" role="presentation">
                    <a class="nav-link" id="pills-keyboard-tab" data-bs-toggle="pill" href="#pills-keyboard" role="tab" aria-controls="pills-keyboard" aria-selected="false" tabindex="-1">
                      <i class="fas fa-keyboard"></i>
                      Keyboard Details
                    </a>
                  </li>
                  <li class="nav-item submenu" role="presentation">
                    <a class="nav-link" id="pills-mouse-tab" data-bs-toggle="pill" href="#pills-mouse" role="tab" aria-controls="pills-mouse" aria-selected="false" tabindex="-1">
                      <i class="fas fa-monument"></i>
                      Mouse Detailss
                    </a>
                  </li>
                  <li class="nav-item submenu" role="presentation">
                    <a class="nav-link" id="pills-ups-tab" data-bs-toggle="pill" href="#pills-ups" role="tab" aria-controls="pills-ups" aria-selected="false" tabindex="-1">
                      <i class="fas fa-battery-full"></i>
                      UPS Details
                    </a>
                  </li>
                  <li class="nav-item submenu" role="presentation">
                    <a class="nav-link" id="pills-user-tab" data-bs-toggle="pill" href="#pills-user" role="tab" aria-controls="pills-user" aria-selected="false" tabindex="-1">
                      <i class="fas fa-user"></i>
                      User Details
                    </a>
                  </li>
                  <li class="nav-item submenu" role="presentation">
                    <a class="nav-link" id="pills-documents-tab" data-bs-toggle="pill" href="#pills-documents" role="tab" aria-controls="pills-documents" aria-selected="false" tabindex="-1">
                      <i class="fas fa-file-alt"></i>
                      Documents
                    </a>
                  </li>
                </ul>
              
                <!-- Tab Content -->
                <div class="tab-content mt-2 mb-3" id="pills-tabContent">
                  <!-- Desktop Details Tab -->
                  <div class="tab-pane fade show active" id="pills-desktop" role="tabpanel" aria-labelledby="pills-desktop-tab">
                    <h4>Desktop Details</h4>
                    <!-- Table for Desktop Details -->
                    <table class="table table-bordered">
                      <tr>
                        <td>Serial Number</td>
                        <td>{{ desktops.desktop_SerialNo }}</td>
                      </tr>
                      <tr>
                        <td>Brand Name</td>
                        <td>{{ desktops.desktop_BrandName }}</td>
                      </tr>
                      <tr>
                        <td>Model</td>
                        <td>{{ desktops.desktop_Model }}</td>
                      </tr>
                      <tr>
                        <td>Processor</td>
                        <td>{{ desktops.desktop_Processor }}</td>
                      </tr>
                      <tr>
                        <td>Memory</td>
                        <td>{{ desktops.desktop_Memory }}</td>
                      </tr>
                      <tr>
                        <td>Drive</td>
                        <td>{{ desktops.desktop_Drive }}</td>
                      </tr>
                    </table>
                  </div>
              
                  <!-- Monitor Details Tab -->
                  <div class="tab-pane fade" id="pills-monitor" role="tabpanel" aria-labelledby="pills-monitor-tab">
                    <h4>Monitor Details</h4>
                    <table class="table table-bordered">
                      <tr>
                        <td>Monitor Serial Number</td>
                        <td>{{ desktops.desktop_Monitor_SN }}</td>
                      </tr>
                      <tr>
                        <td>Monitor Brand</td>
                        <td>{{ desktops.desktop_Monitor_Brand }}</td>
                      </tr>
                      <tr>
                        <td>Monitor Model</td>
                        <td>{{ desktops.desktop_Monitor_Model }}</td>
                      </tr>
                      <tr>
                        <td>Monitor Size</td>
                        <td>{{ desktops.desktop_Monitor_Size }}</td>
                      </tr>
                    </table>
                  </div>
              
                  <!-- Keyboard Details Tab -->
                  <div class="tab-pane fade" id="pills-keyboard" role="tabpanel" aria-labelledby="pills-keyboard-tab">
                    <h4>Keyboard Details</h4>
                    <table class="table table-bordered">
                      <tr>
                        <td>Keyboard Serial Number</td>
                        <td>{{ desktops.desktop_Keyboard_SN }}</td>
                      </tr>
                      <tr>
                        <td>Keyboard Brand</td>
                        <td>{{ desktops.desktop_keyboard_Brand }}</td>
                      </tr>
                      <tr>
                        <td>Keyboard Model</td>
                        <td>{{ desktops.desktop_keyboard_Model }}</td>
                      </tr>
                    </table>
                  </div>
              
                  <!-- Mouse Details Tab -->
                  <div class="tab-pane fade" id="pills-mouse" role="tabpanel" aria-labelledby="pills-mouse-tab">
                    <h4>Mouse Detailss</h4>
                    <table class="table table-bordered">
                      <tr>
                        <td>Mouse Serial Number</td>
                        <td>{{ desktops.desktop_Mouse_SN }}</td>
                      </tr>
                      <tr>
                        <td>Mouse Brand</td>
                        <td>{{ desktops.desktop_Mouse_Brand }}</td>
                      </tr>
                      <tr>
                        <td>Mouse Model</td>
                        <td>{{ desktops.desktop_Mouse_Model }}</td>
                      </tr>
                    </table>
                  </div>
              
                  <!-- UPS Details Tab -->
                  <div class="tab-pane fade" id="pills-ups" role="tabpanel" aria-labelledby="pills-ups-tab">
                    <h4>UPS Details</h4>
                    <table class="table table-bordered">
                      <tr>
                        <td>UPS Serial Number</td>
                        <td>{{ desktops.desktop_UPS_SN }}</td>
                      </tr>
                      <tr>
                        <td>UPS Brand</td>
                        <td>{{ desktops.desktop_UPS_Brand }}</td>
                      </tr>
                      <tr>
                        <td>UPS Model</td>
                        <td>{{ desktops.desktop_UPS_Model }}</td>
                      </tr>
                    </table>
                  </div>
              
                  <!-- User Details Tab -->
                  <div class="tab-pane fade" id="pills-user" role="tabpanel" aria-labelledby="pills-user-tab">
                    <h4>User Details</h4>
                    <table class="table table-bordered">
                      <tr>
                        <td>Asset Owner</td>
                        <td>{{ desktops.desktop_Asset_owner }}</td>
                      </tr>
                      <tr>
                        <td>Asset Designation</td>
                        <td>{{ desktops.desktop_Asset_designation }}</td>
                      </tr>
                      <tr>
                        <td>Asset Section</td>
                        <td>{{ desktops.desktop_Asset_section }}</td>
                      </tr>
                      <tr>
                        <td>End User</td>
                        <td>{{ desktops.desktop_Enduser }}</td>
                      </tr>
                      <tr>
                        <td>End User Designation</td>
                        <td>{{ desktops.desktop_Enduser_designation }}</td>
                      </tr>
                      <tr>
                        <td>End User Section</td>
                        <td>{{ desktops.desktop_Enduser_section }}</td>
                      </tr>
                    </table>
                  </div>
              
                  <!-- Documents Tab -->
                  <div class="tab-pane fade" id="pills-documents" role="tabpanel" aria-labelledby="pills-documents-tab">
                    <h4>Documents</h4>
                    <table class="table table-bordered">
                      <tr>
                        <td>PAR</td>
                        <td>{{ desktops.desktop_PAR }}</td>
                      </tr>
                      <tr>
                        <td>Property Number</td>
                        <td>{{ desktops.desktop_Propertyno }}</td>
                      </tr>
                      <tr>
                        <td>Acquisition Type</td>
                        <td>{{ desktops.desktop_Acquisition_Type }}</td>
                      </tr>
                      <tr>
                        <td>Value</td>
                        <td>{{ desktops.desktop_Value }}</td>
                      </tr>
                      <tr>
                        <td>Date Received</td>
                        <td>{{ desktops.desktop_Datereceived }}</td>
                      </tr>
                      <tr>
                        <td>Date Inspected</td>
                        <td>{{ desktops.desktop_Dateinspected }}</td>
                      </tr>
                      <tr>
                        <td>Supplier</td>
                        <td>{{ desktops.desktop_Supplier }}</td>
                      </tr>
                      <tr>
                        <td>Status</td>
                        <td>{{ desktops.desktop_Status }}</td>
                      </tr>
                      <tr>
                        <td>Computer Name</td>
                        <td>{{ desktops.desktop_Computer_name }}</td>
                      </tr>
                    </table>
                  </div>
                </div>
              </div>
            
              {% csrf_token %}
              <button class="btn btn-primary" type="submit" id="save-btn" style="display:none;">Save Changes</button>
    </form>
    </div>
    {% comment %} end content here {% endcomment %}
    
    
            <div id="myChartLegend"><ul class="0-legend html-legend"><li><span style="background-color:#f3545d"></span>Subscribers</li><li><span style="background-color:#fdaf4b"></span>New Visitors</li><li><span style="background-color:#177dff"></span>Active Users</li></ul></div>
          </div>
        </div>
      </div>
      <div class="col-md-4">
        <div class="card card-primary card-round">
      
            <div class="card card-primary card-round">
              <div class="card-body pb-0">
                <div class="mb-4 mt-2 image-wrapper">
                  <h1>Desktop Image</h1>
                  {% if desktops.desktop_Image %}
                  <img src="{{ desktops.desktop_Image.url }}" alt="Desktop Image" class="img-fluid">    
              {% else %}
                  <p>No image available.</p>
              {% endif %}
                </div>
                </div>
              </div>  
        </div>
      </div>

  <!-- Edit Row Script -->
  <script>
    function editRow(rowId) {
      event.preventDefault();  // Prevent form submission on button click
      // Hide the view element
      document.getElementById(rowId + '-view').style.display = 'none';
      // Show the input field for editing
      document.getElementById(rowId + '-edit').style.display = 'block';

      // Show the Save Changes button
      document.getElementById('save-btn').style.display = 'block';
    }
  </script>

  <!-- Modal -->
  <div class="modal fade" id="disposeModal" tabindex="-1" aria-labelledby="disposeModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <!-- Modal Header -->
        <div class="modal-header">
          <h5 class="modal-title" id="disposeModalLabel">Confirm Disposal</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <!-- Modal Body -->
        <div class="modal-body">
          Are you sure you want to dispose of this Desktop Package?
        </div>
        <!-- Modal Footer -->
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <!-- Save Disposal Button with Desktop ID -->
          <button type="button" class="btn btn-primary" id="saveDisposeBtn" data-desktop-id="{{ desktops.id }}">Yes, Dispose</button>
        </div>
      </div>
    </div>
  </div>

  <!-- JavaScript for Disposal -->
  <script>
    // Function to get CSRF token from cookies
    function getCookie(name) {
        let cookieValue = null;
        if (document.cookie && document.cookie !== '') {
            const cookies = document.cookie.split(';');
            for (let cookie of cookies) {
                cookie = cookie.trim();
                if (cookie.substring(0, name.length + 1) === (name + '=')) {
                    cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                    break;
                }
            }
        }
        return cookieValue;
    }
    
    document.getElementById('saveDisposeBtn').addEventListener('click', function () {
        const desktopId = this.getAttribute('data-desktop-id');
        fetch(`/dispose_desktop/${desktopId}/`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': getCookie('csrftoken')
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                alert('Desktop package has been marked as disposed.');
                window.location.href = "/disposed_desktop_list/";  // Redirect to the list of disposed desktops
            } else {
                alert('Error disposing desktop.');
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('Error disposing desktop.');
        });
    });
    </script>
     
</div>
{% endblock %}
