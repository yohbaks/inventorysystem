{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="container">
  <div class="page-inner">
    <!-- Header -->
    <div class="d-flex align-items-left align-items-md-center flex-column flex-md-row pt-2 pb-4">
      <div>
        <h3 class="fw-bold mb-1">Dashboard</h3>
        <p class="text-muted mb-0">Asset Sync Inventory System V3</p>
      </div>
      <div class="ms-md-auto py-2 py-md-0">
        <a href="{% url 'add_equipment_package_with_details' %}" class="btn btn-primary btn-round">
          <i class="fas fa-plus me-1"></i> Add Item
        </a>
      </div>
    </div>

    <!-- KPI Row 1 -->
    <div class="row g-3 mb-3">
      <!-- Total Packages -->
      <div class="col-sm-6 col-md-3">
        <div class="card card-stats card-primary card-round shadow-sm">
          <div class="card-body">
            <div class="row align-items-center">
              <div class="col-5">
                <div class="icon-big text-center">
                  <i class="fas fa-boxes"></i>
                </div>
              </div>
              <div class="col-7 col-stats text-center">
                <div class="numbers">
                  <p class="card-category mb-0">Total Packages</p>
                  <h4 class="card-title mb-0">{{ kpis.total_packages }}</h4>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Active Packages -->
      <div class="col-sm-6 col-md-3">
        <div class="card card-stats card-success card-round shadow-sm">
          <div class="card-body">
            <div class="row align-items-center">
              <div class="col-5">
                <div class="icon-big text-center">
                  <i class="far fa-check-circle"></i>
                </div>
              </div>
              <div class="col-7 col-stats text-center">
                <div class="numbers">
                  <p class="card-category mb-0">Active Packages</p>
                  <h4 class="card-title mb-0">{{ kpis.active_packages }}</h4>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Disposed (All) -->
      <div class="col-sm-6 col-md-3">
        <div class="card card-stats card-danger card-round shadow-sm">
          <div class="card-body">
            <div class="row align-items-center">
              <div class="col-5">
                <div class="icon-big text-center">
                  <i class="far fa-trash-alt"></i>
                </div>
              </div>
              <div class="col-7 col-stats text-center">
                <div class="numbers">
                  <p class="card-category mb-0">Disposed (All)</p>
                  <h4 class="card-title mb-0">{{ kpis.disposed_all }}</h4>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Pending PM -->
      <div class="col-sm-6 col-md-3">
        <div class="card card-stats card-info card-round shadow-sm">
          <div class="card-body">
            <div class="row align-items-center">
              <div class="col-5">
                <div class="icon-big text-center">
                  <i class="far fa-calendar-alt"></i>
                </div>
              </div>
              <div class="col-7 col-stats text-center">
                <div class="numbers">
                  <p class="card-category mb-0">Pending PM</p>
                  <h4 class="card-title mb-0">{{ kpis.pm_pending }}</h4>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- KPI Row 2 - Equipment Categories -->
    <div class="row g-3 mb-3">
      <!-- Desktops -->
      <div class="col-sm-6 col-md-2">
        <div class="card shadow-sm border-0 text-center">
          <div class="card-body py-3">
            <i class="fas fa-desktop fa-2x text-primary mb-2"></i>
            <p class="fw-bold text-muted small mb-1">Desktops</p>
            <h5 class="fw-bold text-dark mb-0">{{ kpis.total_desktops }}</h5>
          </div>
        </div>
      </div>

      <!-- Laptops -->
      <div class="col-sm-6 col-md-2">
        <div class="card shadow-sm border-0 text-center">
          <div class="card-body py-3">
            <i class="fas fa-laptop fa-2x text-info mb-2"></i>
            <p class="fw-bold text-muted small mb-1">Laptops</p>
            <h5 class="fw-bold text-dark mb-0">{{ kpis.total_laptops }}</h5>
          </div>
        </div>
      </div>

      <!-- Printers -->
      <div class="col-sm-6 col-md-2">
        <div class="card shadow-sm border-0 text-center">
          <div class="card-body py-3">
            <i class="fas fa-print fa-2x text-purple mb-2"></i>
            <p class="fw-bold text-muted small mb-1">Printers</p>
            <h5 class="fw-bold text-dark mb-0">{{ kpis.total_printers }}</h5>
          </div>
        </div>
      </div>

      <!-- UPS -->
      <div class="col-sm-6 col-md-2">
        <div class="card shadow-sm border-0 text-center">
          <div class="card-body py-3">
            <i class="fas fa-plug fa-2x text-warning mb-2"></i>
            <p class="fw-bold text-muted small mb-1">UPS Units</p>
            <h5 class="fw-bold text-dark mb-0">{{ kpis.total_ups }}</h5>
          </div>
        </div>
      </div>

      <!-- Monitors -->
      <div class="col-sm-6 col-md-2">
        <div class="card shadow-sm border-0 text-center">
          <div class="card-body py-3">
            <i class="fas fa-tv fa-2x text-secondary mb-2"></i>
            <p class="fw-bold text-muted small mb-1">Monitors</p>
            <h5 class="fw-bold text-dark mb-0">{{ kpis.total_monitors|default:"0" }}</h5>
          </div>
        </div>
      </div>

      <!-- Health Score -->
      <div class="col-sm-6 col-md-2">
        <div class="card shadow-sm border-0 text-center">
          <div class="card-body py-3">
            <i class="fas fa-heartbeat fa-2x text-success mb-2"></i>
            <p class="fw-bold text-muted small mb-1">Health Score</p>
            <h5 class="fw-bold text-dark mb-0">{{ kpis.health_score }}%</h5>
          </div>
        </div>
      </div>
    </div>

    <!-- Charts Row 1 -->
    <div class="row g-3 mb-3">
      <div class="col-lg-8">
        <div class="card shadow-sm">
          <div class="card-header">
            <h5 class="card-title mb-0">Disposal Trend (Last {{ charts.months }} Months)</h5>
          </div>
          <div class="card-body">
            <div class="chart-container" style="height: 320px;">
              <canvas id="disposalTrendChart"></canvas>
            </div>
          </div>
        </div>
      </div>

      <div class="col-lg-4">
        <div class="card shadow-sm">
          <div class="card-header">
            <h5 class="card-title mb-0">Disposed by Category</h5>
          </div>
          <div class="card-body">
            <div class="chart-container" style="height: 320px;">
              <canvas id="disposedByCategoryChart"></canvas>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Charts Row 2 -->
    <div class="row g-3 mb-3">
      <div class="col-lg-6">
        <div class="card shadow-sm">
          <div class="card-header">
            <h5 class="card-title mb-0">Active vs Disposed by Category</h5>
          </div>
          <div class="card-body">
            <div class="chart-container" style="height: 300px;">
              <canvas id="activeDisposedStacked"></canvas>
            </div>
          </div>
        </div>
      </div>

      <div class="col-lg-6">
        <div class="card shadow-sm">
          <div class="card-header">
            <h5 class="card-title mb-0">Top 5 Brands</h5>
          </div>
          <div class="card-body">
            <div class="chart-container" style="height: 300px;">
              <canvas id="brandChart"></canvas>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Charts Row 3 -->
    <div class="row g-3 mb-3">
      <div class="col-lg-12">
        <div class="card shadow-sm">
          <div class="card-header">
            <h5 class="card-title mb-0">Assets by Office Section</h5>
          </div>
          <div class="card-body">
            <div class="chart-container" style="height: 400px;">
              <canvas id="sectionChart"></canvas>
            </div>
          </div>
        </div>
      </div>
    </div>

<!-- Recent Activity & Audit Trail -->
<div class="row g-3 mb-3">
  <!-- Recently Added -->
  <div class="col-xl-6">
    <div class="card shadow-sm">
      <div class="card-header">
        <h5 class="card-title mb-0">Recently Added IT Equipment</h5>
      </div>
      <div class="card-body">
        <div class="table-responsive">
          <table class="table table-hover align-items-center mb-0">
            <thead class="thead-light">
              <tr>
                <th>Type</th>
                <th>Computer Name</th>
                <th>Serial</th>
                <th>Brand</th>
                <th>Model</th>
                <th>Created</th>
                <th class="text-center">Actions</th>
              </tr>
            </thead>
            <tbody>
              {% for item in recent %}
              <tr>
                <td>
                  {% if item.type == 'Desktop' %}
                    <span class="badge bg-primary">
                      <i class="fas fa-desktop"></i> Desktop
                    </span>
                  {% elif item.type == 'Laptop' %}
                    <span class="badge bg-info">
                      <i class="fas fa-laptop"></i> Laptop
                    </span>
                  {% else %}
                    <span class="badge bg-secondary">{{ item.type }}</span>
                  {% endif %}
                </td>
                <td class="fw-bold">{{ item.computer_name }}</td>
                <td>{{ item.serial_no }}</td>
                <td>{{ item.brand_name }}</td>
                <td>{{ item.model }}</td>
                <td>{{ item.created_at|date:"M d, Y" }}</td>
                <td class="text-center">
                  {% if item.url_name %}
                    <a href="{% url item.url_name item.id %}" class="btn btn-sm btn-outline-primary">
                      <i class="fa fa-eye"></i> View
                    </a>
                  {% else %}
                    <a href="{% url 'desktop_details_view' item.id %}" class="btn btn-sm btn-outline-primary">
                      <i class="fa fa-eye"></i> View
                    </a>
                  {% endif %}
                </td>
              </tr>
              {% empty %}
              <tr>
                <td colspan="7" class="text-muted text-center py-4">No recent items</td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
  

  <!-- ==================== PREMIUM ENHANCED AUDIT TRAIL ==================== -->
<!-- Version with Timeline View + Better Animations -->

<div class="col-xl-6">
  <div class="card shadow-lg border-0" style="border-radius: 24px; overflow: hidden;">
    
    <!-- Gradient Header -->
    <div class="audit-header-gradient" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 50%, #ec4899 100%); padding: 2rem; position: relative; overflow: hidden;">
      <!-- Animated Background Elements -->
      <div style="position: absolute; top: -50%; right: -10%; width: 200px; height: 200px; background: rgba(255,255,255,0.1); border-radius: 50%; animation: float 6s ease-in-out infinite;"></div>
      <div style="position: absolute; bottom: -30%; left: -5%; width: 150px; height: 150px; background: rgba(255,255,255,0.1); border-radius: 50%; animation: float 8s ease-in-out infinite;"></div>
      
      <!-- Header Content -->
      <div style="position: relative; z-index: 1;">
        <div class="d-flex align-items-center justify-content-between mb-3">
          <div class="d-flex align-items-center">
            <div style="width: 48px; height: 48px; background: rgba(255,255,255,0.2); backdrop-filter: blur(10px); border-radius: 12px; display: flex; align-items: center; justify-content: center; margin-right: 1rem;">
              <i class="fas fa-history text-white" style="font-size: 24px;"></i>
            </div>
            <div>
              <h5 class="text-white fw-bold mb-1" style="font-size: 1.25rem;">Activity Timeline</h5>
              <p class="text-white mb-0" style="font-size: 0.875rem; opacity: 0.9;">Recent transfer history</p>
            </div>
          </div>
          <div class="d-flex align-items-center gap-2">
            <span class="badge bg-white text-primary px-3 py-2 rounded-pill" style="font-weight: 600; box-shadow: 0 4px 12px rgba(0,0,0,0.15);">
              <i class="fas fa-circle text-success me-1" style="font-size: 8px; animation: pulse 2s ease-in-out infinite;"></i>
              Live
            </span>
          </div>
        </div>

        <!-- Stats Bar -->
        <div class="row g-2 mt-3">
          <div class="col-6">
            <div style="background: rgba(255,255,255,0.15); backdrop-filter: blur(10px); border-radius: 12px; padding: 0.75rem; border: 1px solid rgba(255,255,255,0.2);">
              <div class="text-white" style="font-size: 0.75rem; opacity: 0.9; text-transform: uppercase; letter-spacing: 0.5px;">Total Today</div>
              <div class="text-white fw-bold" style="font-size: 1.5rem;">{{ audit|length }}</div>
            </div>
          </div>
          <div class="col-6">
            <div style="background: rgba(255,255,255,0.15); backdrop-filter: blur(10px); border-radius: 12px; padding: 0.75rem; border: 1px solid rgba(255,255,255,0.2);">
              <div class="text-white" style="font-size: 0.75rem; opacity: 0.9; text-transform: uppercase; letter-spacing: 0.5px;">Last Update</div>
              <div class="text-white fw-bold" style="font-size: 1.5rem;">
                {% if audit %}{{ audit.0.when|slice:"-5:" }}{% else %}--:--{% endif %}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Timeline Body -->
    <div class="audit-timeline-body" style="padding: 1.5rem; max-height: 600px; overflow-y: auto; background: #fafbfc;">
      {% if audit %}
        <div class="timeline-container">
          {% for ev in audit %}
          <div class="timeline-item" style="position: relative; padding-left: 3rem; padding-bottom: 2rem;">
            
            <!-- Timeline Connector Line -->
            {% if not forloop.last %}
            <div style="position: absolute; left: 23px; top: 48px; width: 2px; height: calc(100% - 48px); background: linear-gradient(180deg, #e5e7eb 0%, transparent 100%);"></div>
            {% endif %}

            <!-- Timeline Icon -->
            <div style="position: absolute; left: 0; top: 0;">
              {% if ev.type == "End User" %}
                <div class="timeline-icon" style="width: 48px; height: 48px; border-radius: 50%; background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%); display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4); border: 4px solid white;">
                  <i class="fas fa-user-tag text-white" style="font-size: 18px;"></i>
                </div>
              {% else %}
                <div class="timeline-icon" style="width: 48px; height: 48px; border-radius: 50%; background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 12px rgba(245, 158, 11, 0.4); border: 4px solid white;">
                  <i class="fas fa-shield-alt text-white" style="font-size: 18px;"></i>
                </div>
              {% endif %}
            </div>

            <!-- Timeline Card -->
            <div class="timeline-card" style="background: white; border-radius: 16px; padding: 1.25rem; box-shadow: 0 4px 12px rgba(0,0,0,0.08); border: 1px solid #e5e7eb; transition: all 0.3s ease;">
              
              <!-- Card Header -->
              <div class="d-flex align-items-center justify-content-between mb-2">
                {% if ev.type == "End User" %}
                  <span class="badge" style="background: linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%); color: #1e40af; padding: 0.375rem 0.875rem; border-radius: 8px; font-weight: 600; font-size: 0.75rem;">
                    <i class="fas fa-user me-1"></i>End User
                  </span>
                {% else %}
                  <span class="badge" style="background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%); color: #92400e; padding: 0.375rem 0.875rem; border-radius: 8px; font-weight: 600; font-size: 0.75rem;">
                    <i class="fas fa-building me-1"></i>Asset Owner
                  </span>
                {% endif %}
                
                <div class="d-flex align-items-center" style="font-size: 0.813rem; color: #6b7280;">
                  <i class="far fa-clock me-1"></i>
                  <span>{{ ev.when }}</span>
                </div>
              </div>

              <!-- Card Content -->
              <div class="timeline-content" style="font-size: 0.938rem; color: #374151; line-height: 1.6; margin-bottom: 0.75rem;">
                {{ ev.text|safe }}
              </div>

              <!-- Card Footer -->
              <div class="d-flex align-items-center justify-content-between">
                <span class="badge bg-success-subtle text-success" style="padding: 0.25rem 0.625rem; border-radius: 6px; font-size: 0.75rem;">
                  <i class="fas fa-check-circle me-1"></i>Completed
                </span>
                <button class="btn btn-sm" style="color: #6b7280; background: transparent; border: none; padding: 0.25rem 0.5rem; font-size: 0.813rem;" onclick="alert('View details')">
                  <i class="fas fa-info-circle me-1"></i>Details
                </button>
              </div>
            </div>
          </div>
          {% endfor %}
        </div>

      {% else %}
        <!-- Empty State -->
        <div class="text-center py-5">
          <div class="empty-state-icon mb-4" style="width: 120px; height: 120px; border-radius: 50%; background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%); display: flex; align-items: center; justify-content: center; margin: 0 auto; position: relative;">
            <div style="position: absolute; inset: 0; border-radius: 50%; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); opacity: 0.1; animation: pulse 3s ease-in-out infinite;"></div>
            <i class="fas fa-history" style="font-size: 48px; color: #9ca3af; position: relative; z-index: 1;"></i>
          </div>
          <h5 class="fw-bold text-dark mb-2">No Activity Yet</h5>
          <p class="text-muted mb-4" style="font-size: 0.938rem; max-width: 300px; margin: 0 auto;">
            Transfer activities and changes will appear here in real-time
          </p>
          <button class="btn btn-sm rounded-pill" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 0.625rem 1.5rem; font-weight: 600;">
            <i class="fas fa-plus me-2"></i>Make First Transfer
          </button>
        </div>
      {% endif %}
    </div>

    <!-- Card Footer -->
    <div class="card-footer bg-white border-0" style="padding: 1.25rem 1.5rem;">
      <div class="d-flex align-items-center justify-content-between">
        <div class="d-flex align-items-center" style="font-size: 0.875rem; color: #6b7280;">
          <i class="fas fa-info-circle me-2"></i>
          <span>Showing last 10 activities</span>
        </div>
        <a href="#" class="btn btn-sm rounded-pill" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; font-weight: 600; padding: 0.5rem 1.5rem; box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);">
          <i class="fas fa-history me-2"></i>View All
        </a>
      </div>
    </div>

  </div>
</div>



 <!-- ==================== END PREMIUM ENHANCED AUDIT TRAIL ==================== -->

  </div>
</div>
{% endblock %}

{% block scripts %}
{{ block.super }}
<script>
// ========= Chart Data =========
const DISP_LABELS = {{ charts.labels|safe }};
const DISP_DESKTOP = {{ charts.desktop|safe }};
const DISP_MOUSE = {{ charts.mouse|safe }};
const DISP_KEYBOARD = {{ charts.keyboard|safe }};
const DISP_UPS = {{ charts.ups|safe }};
const DISPOSED_BY_CAT_LABELS = {{ charts.disposed_by_cat_labels|safe }};
const DISPOSED_BY_CAT_DATA = {{ charts.disposed_by_cat_data|safe }};
const ACTIVE_VS_DISPOSED_LABELS = {{ charts.stack_labels|safe }};
const ACTIVE_COUNTS = {{ charts.stack_active|safe }};
const DISPOSED_COUNTS = {{ charts.stack_disposed|safe }};
const BRAND_LABELS = {{ charts.brand_labels|safe }};
const BRAND_DATA = {{ charts.brand_data|safe }};
const SECTION_LABELS = {{ charts.section_labels|safe }};
const SECTION_DATA = {{ charts.section_data|safe }};

// ========= Initialize Charts =========
(function() {
  // 1. Disposal Trend Line Chart (Styled like reference)
  var disposalCanvas = document.getElementById('disposalTrendChart');
  if (disposalCanvas) {
    var disposalCtx = disposalCanvas.getContext('2d');
    
    var myDisposalChart = new Chart(disposalCtx, {
      type: 'line',
      data: {
        labels: DISP_LABELS,
        datasets: [
          {
            label: 'Desktop',
            borderColor: '#1d7af3',
            pointBorderColor: '#FFF',
            pointBackgroundColor: '#1d7af3',
            pointBorderWidth: 2,
            pointHoverRadius: 4,
            pointHoverBorderWidth: 1,
            pointRadius: 4,
            backgroundColor: 'transparent',
            fill: true,
            tension: 0.4,  // ✅ this line makes it curve
            borderWidth: 2,
            data: DISP_DESKTOP
          },
          {
            label: 'Mouse',
            borderColor: '#59d05d',
            pointBorderColor: '#FFF',
            pointBackgroundColor: '#59d05d',
            pointBorderWidth: 2,
            pointHoverRadius: 4,
            pointHoverBorderWidth: 1,
            pointRadius: 4,
            backgroundColor: 'transparent',
            fill: true,
            borderWidth: 2,
            data: DISP_MOUSE
          },
          {
            label: 'Keyboard',
            borderColor: '#f3545d',
            pointBorderColor: '#FFF',
            pointBackgroundColor: '#f3545d',
            pointBorderWidth: 2,
            pointHoverRadius: 4,
            pointHoverBorderWidth: 1,
            pointRadius: 4,
            backgroundColor: 'transparent',
            fill: true,
            borderWidth: 2,
            data: DISP_KEYBOARD
          },
          {
            label: 'UPS',
            borderColor: '#fdaf4b',
            pointBorderColor: '#FFF',
            pointBackgroundColor: '#fdaf4b',
            pointBorderWidth: 2,
            pointHoverRadius: 4,
            pointHoverBorderWidth: 1,
            pointRadius: 4,
            backgroundColor: 'transparent',
            fill: true,
            borderWidth: 2,
            data: DISP_UPS
          }
        ]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        legend: {
          position: 'bottom',
          labels: {
            padding: 10,
            fontColor: '#1d7af3'
          }
        },
        tooltips: {
          bodySpacing: 4,
          mode: 'nearest',
          intersect: 0,
          position: 'nearest',
          xPadding: 10,
          yPadding: 10,
          caretPadding: 10
        },
        layout: {
          padding: { left: 15, right: 15, top: 15, bottom: 15 }
        },
        scales: {
          yAxes: [{
            ticks: {
              beginAtZero: true,
              stepSize: 5
            }
          }]
        }
      }
    });
  }

  // 2. Disposed by Category Pie Chart
  var pieCanvas = document.getElementById('disposedByCategoryChart');
  if (pieCanvas) {
    var pieCtx = pieCanvas.getContext('2d');
    
    var myPieChart = new Chart(pieCtx, {
      type: 'pie',
      data: {
        datasets: [{
          data: DISPOSED_BY_CAT_DATA,
          backgroundColor: ['#1d7af3', '#f3545d', '#fdaf4b', '#59d05d', '#716aca'],
          borderWidth: 0
        }],
        labels: DISPOSED_BY_CAT_LABELS
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        legend: {
          position: 'bottom',
          labels: {
            fontColor: 'rgb(154, 154, 154)',
            fontSize: 11,
            usePointStyle: true,
            padding: 20
          }
        },
        pieceLabel: {
          render: 'percentage',
          fontColor: 'white',
          fontSize: 14
        },
        tooltips: false,
        layout: {
          padding: {
            left: 20,
            right: 20,
            top: 20,
            bottom: 20
          }
        }
      }
    });
  }

  // 3. Active vs Disposed Stacked Bar Chart
  var stackedCanvas = document.getElementById('activeDisposedStacked');
  if (stackedCanvas) {
    var stackedCtx = stackedCanvas.getContext('2d');
    
    var myStackedChart = new Chart(stackedCtx, {
      type: 'bar',
      data: {
        labels: ACTIVE_VS_DISPOSED_LABELS,
        datasets: [
          {
            label: 'Active',
            backgroundColor: '#59d05d',
            borderColor: '#59d05d',
            data: ACTIVE_COUNTS
          },
          {
            label: 'Disposed',
            backgroundColor: '#f3545d',
            borderColor: '#f3545d',
            data: DISPOSED_COUNTS
          }
        ]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        legend: {
          position: 'bottom'
        },
        title: {
          display: false
        },
        tooltips: {
          mode: 'index',
          intersect: false
        },
        scales: {
          xAxes: [{
            stacked: true
          }],
          yAxes: [{
            stacked: true,
            ticks: {
              beginAtZero: true,
              stepSize: 5
            }
          }]
        }
      }
    });
  }

  // 4. Top 5 Brands Bar Chart
  var brandCanvas = document.getElementById('brandChart');
  if (brandCanvas) {
    var brandCtx = brandCanvas.getContext('2d');
    
    var myBrandChart = new Chart(brandCtx, {
      type: 'bar',
      data: {
        labels: BRAND_LABELS,
        datasets: [{
          label: 'Assets',
          backgroundColor: 'rgb(23, 125, 255)',
          borderColor: 'rgb(23, 125, 255)',
          data: BRAND_DATA
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        legend: {
          display: false
        },
        scales: {
          yAxes: [{
            ticks: {
              beginAtZero: true,
              stepSize: 5
            }
          }]
        }
      }
    });
  }

  // 5. Assets by Section Horizontal Bar Chart
  var sectionCanvas = document.getElementById('sectionChart');
  if (sectionCanvas) {
    var sectionCtx = sectionCanvas.getContext('2d');
    
    var mySectionChart = new Chart(sectionCtx, {
      type: 'horizontalBar',
      data: {
        labels: SECTION_LABELS,
        datasets: [{
          label: 'Assets',
          backgroundColor: '#59d05d',
          borderColor: '#59d05d',
          data: SECTION_DATA
        }]
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        legend: {
          display: false
        },
        scales: {
          xAxes: [{
            ticks: {
              beginAtZero: true,
              stepSize: 5
            }
          }]
        }
      }
    });
  }
})();
</script>
{% endblock %}