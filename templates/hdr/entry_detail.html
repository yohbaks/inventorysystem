{% extends 'base.html' %}
{% load static %}

{% block title %}Job Sheet Detail - {{ entry.ref_number }}{% endblock %}

{% block extra_css %}
<style>
:root {
  --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
  --gradient-info: linear-gradient(135deg, #17a2b8 0%, #138496 100%);
  --gradient-success: linear-gradient(135deg, #10b981 0%, #059669 100%);
  --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
  --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
}

.status-fixed { background: #c6f6d5; color: #22543d; padding: 6px 16px; border-radius: 20px; font-weight: 600; display: inline-block; }
.status-for-repair { background: #fed7d7; color: #742a2a; padding: 6px 16px; border-radius: 20px; font-weight: 600; display: inline-block; }
.status-for-disposal { background: #feebc8; color: #7c2d12; padding: 6px 16px; border-radius: 20px; font-weight: 600; display: inline-block; }

.modern-tabs {
  background: white;
  border-radius: 1rem;
  padding: 0.5rem;
  box-shadow: var(--shadow-lg);
  margin-bottom: 2rem;
}

.modern-tabs .nav-link {
  border-radius: 0.75rem;
  font-weight: 600;
  padding: 0.75rem 1.5rem;
  color: #64748b;
  transition: all 0.3s;
}

.modern-tabs .nav-link:hover {
  color: #667eea;
  background: rgba(102, 126, 234, 0.1);
}

.modern-tabs .nav-link.active {
  background: var(--gradient-primary);
  color: white;
}

.modern-card {
  background: white;
  border-radius: 1.5rem;
  box-shadow: var(--shadow-lg);
  overflow: hidden;
  margin-bottom: 1.5rem;
}

.card-header-modern {
  padding: 1.5rem;
  border-bottom: 1px solid #f1f5f9;
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.card-title-modern {
  font-size: 1.25rem;
  font-weight: 700;
  color: #1e293b;
  margin: 0;
}

.detail-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 1.5rem;
  padding: 1.5rem;
}

.detail-item {
  background: #f8fafc;
  padding: 1rem;
  border-radius: 0.75rem;
  border-left: 4px solid #667eea;
}

.detail-label {
  font-size: 0.75rem;
  font-weight: 600;
  text-transform: uppercase;
  color: #64748b;
  margin-bottom: 0.5rem;
  letter-spacing: 0.5px;
}

.detail-value {
  font-size: 1rem;
  color: #1e293b;
  font-weight: 500;
}

.detail-value.empty {
  color: #94a3b8;
  font-style: italic;
}

.evaluation-badge {
  background: linear-gradient(135deg, #10b981 0%, #059669 100%);
  color: white;
  padding: 0.5rem 1rem;
  border-radius: 0.5rem;
  font-weight: 600;
  display: inline-block;
}
</style>
{% endblock %}

{% block content %}
<div class="modern-container">
  <div class="container-fluid">

    <!-- Hero Header -->
    <div class="premium-page-header theme-info">
      <div class="hero-content">
        <div class="d-flex justify-content-between align-items-start flex-wrap">
          <div class="flex-grow-1">
            <div class="hero-badge">
              <i class="fas fa-file-alt"></i>
              <span>Job Sheet</span>
            </div>
            <h1 class="hero-title text-white">{{ entry.ref_number }}</h1>

            <div class="info-cards">
              <div class="info-card">
                <div class="info-label">Reported By</div>
                <div class="info-value text-white">{{ entry.reported_by }}</div>
                <div class="text-white"><small style="opacity: 0.9;">{{ entry.section_division|default:"No section specified" }}</small></div>
              </div>
              <div class="info-card">
                <div class="info-label">Date Filed</div>
                <div class="info-value text-white">{{ entry.date_reported|date:"F d, Y" }}</div>
                <div class="text-white"><small style="opacity: 0.9;">{{ entry.get_incident_type_display }}</small></div>
              </div>
              <div class="info-card">
                <div class="info-label">Status</div>
                <div class="info-value">
                  <span class="status-{{ entry.status|slugify }}">{{ entry.get_status_display }}</span>
                </div>
                <div class="text-white"><small style="opacity: 0.9;">{{ entry.get_main_category_display }}</small></div>
              </div>
            </div>
          </div>

          <div class="action-buttons mt-3 mt-md-0">
            <a href="{% url 'hdr_entry_export' entry.id %}" class="modern-btn btn-primary">
              <i class="fa fa-file-excel"></i>
              Export
            </a>
            <button class="modern-btn btn-secondary" onclick="window.print()">
              <i class="fas fa-print"></i>
              Print
            </button>
            <a href="{% url 'hdr_edit' report.id %}" class="modern-btn btn-secondary">
              <i class="fas fa-arrow-left"></i>
              Back
            </a>
          </div>
        </div>
      </div>
    </div>

    <!-- Modern Tab Navigation -->
    <ul class="nav nav-pills nav-secondary nav-pills-no-bd modern-tabs" id="pills-tab" role="tablist">
      <li class="nav-item" role="presentation">
        <button class="nav-link active modern-btn" id="pills-basic-tab" data-bs-toggle="pill" data-bs-target="#pills-basic" type="button" role="tab">
          <i class="fas fa-info-circle"></i> Basic Info
        </button>
      </li>
      {% if entry.hardware_type or entry.application_description or entry.connectivity_description or entry.user_account_description %}
      <li class="nav-item" role="presentation">
        <button class="nav-link modern-btn" id="pills-technical-tab" data-bs-toggle="pill" data-bs-target="#pills-technical" type="button" role="tab">
          <i class="fas fa-tools"></i> Technical Details
        </button>
      </li>
      {% endif %}
      {% if entry.assessment or entry.resolution %}
      <li class="nav-item" role="presentation">
        <button class="nav-link modern-btn" id="pills-assessment-tab" data-bs-toggle="pill" data-bs-target="#pills-assessment" type="button" role="tab">
          <i class="fas fa-clipboard-check"></i> Assessment
        </button>
      </li>
      {% endif %}
      {% if entry.concern_addressed or entry.satisfaction_service or entry.satisfaction_solution or entry.client_comments %}
      <li class="nav-item" role="presentation">
        <button class="nav-link modern-btn" id="pills-evaluation-tab" data-bs-toggle="pill" data-bs-target="#pills-evaluation" type="button" role="tab">
          <i class="fas fa-star"></i> Client Evaluation
        </button>
      </li>
      {% endif %}
    </ul>

    <!-- Tab Content -->
    <div class="tab-content" id="pills-tabContent">

      <!-- Basic Info Tab -->
      <div class="tab-pane fade show active" id="pills-basic" role="tabpanel">
        <div class="modern-card">
          <div class="card-header-modern">
            <h2 class="card-title-modern"><i class="fas fa-user-circle mr-2"></i>Client Information</h2>
          </div>

          <div class="detail-grid">
            <div class="detail-item">
              <div class="detail-label">Full Name</div>
              <div class="detail-value">{{ entry.reported_by }}</div>
            </div>
            <div class="detail-item">
              <div class="detail-label">Date of Filing</div>
              <div class="detail-value">{{ entry.date_reported|date:"F d, Y" }}</div>
            </div>
            <div class="detail-item">
              <div class="detail-label">Section/Division</div>
              <div class="detail-value {% if not entry.section_division %}empty{% endif %}">
                {{ entry.section_division|default:"Not specified" }}
              </div>
            </div>
            <div class="detail-item">
              <div class="detail-label">Contact Number</div>
              <div class="detail-value {% if not entry.contact_no %}empty{% endif %}">
                {{ entry.contact_no|default:"Not specified" }}
              </div>
            </div>
          </div>

          <div style="padding: 0 1.5rem 1.5rem;">
            <div class="detail-item">
              <div class="detail-label">Brief Description</div>
              <div class="detail-value">{{ entry.description }}</div>
            </div>
          </div>
        </div>

        <div class="modern-card">
          <div class="card-header-modern">
            <h2 class="card-title-modern"><i class="fas fa-tags mr-2"></i>Incident Classification</h2>
          </div>

          <div class="detail-grid">
            <div class="detail-item">
              <div class="detail-label">Type of Incident</div>
              <div class="detail-value">{{ entry.get_incident_type_display }}</div>
            </div>
            <div class="detail-item">
              <div class="detail-label">Main Category</div>
              <div class="detail-value">{{ entry.get_main_category_display }}</div>
            </div>
            <div class="detail-item">
              <div class="detail-label">Sub-Category</div>
              <div class="detail-value">{{ entry.sub_category }}</div>
            </div>
            <div class="detail-item">
              <div class="detail-label">Status</div>
              <div class="detail-value">
                <span class="status-{{ entry.status|lower|cut:' ' }}">{{ entry.get_status_display }}</span>
              </div>
            </div>
          </div>
        </div>

        <div class="modern-card">
          <div class="card-header-modern">
            <h2 class="card-title-modern"><i class="fas fa-users mr-2"></i>Personnel Information</h2>
          </div>

          <div class="detail-grid">
            <div class="detail-item">
              <div class="detail-label">Mode of Filing</div>
              <div class="detail-value {% if not entry.mode_of_filing %}empty{% endif %}">
                {{ entry.mode_of_filing|default:"Not specified" }}
              </div>
            </div>
            <div class="detail-item">
              <div class="detail-label">Fulfilled By</div>
              <div class="detail-value {% if not entry.fulfilled_by %}empty{% endif %}">
                {{ entry.fulfilled_by|default:"Not specified" }}
              </div>
            </div>
            <div class="detail-item">
              <div class="detail-label">Reviewed By</div>
              <div class="detail-value {% if not entry.reviewed_by %}empty{% endif %}">
                {{ entry.reviewed_by|default:"Not specified" }}
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Technical Details Tab -->
      {% if entry.hardware_type or entry.application_description or entry.connectivity_description or entry.user_account_description %}
      <div class="tab-pane fade" id="pills-technical" role="tabpanel">
        {% if entry.hardware_type or entry.hardware_brand_model or entry.hardware_serial_number or entry.computer_name %}
        <div class="modern-card">
          <div class="card-header-modern">
            <h2 class="card-title-modern"><i class="fas fa-laptop mr-2"></i>Hardware Details</h2>
          </div>

          <div class="detail-grid">
            <div class="detail-item">
              <div class="detail-label">Type</div>
              <div class="detail-value {% if not entry.hardware_type %}empty{% endif %}">
                {{ entry.hardware_type|default:"Not specified" }}
              </div>
            </div>
            <div class="detail-item">
              <div class="detail-label">Brand and Model</div>
              <div class="detail-value {% if not entry.hardware_brand_model %}empty{% endif %}">
                {{ entry.hardware_brand_model|default:"Not specified" }}
              </div>
            </div>
            <div class="detail-item">
              <div class="detail-label">Serial Number</div>
              <div class="detail-value {% if not entry.hardware_serial_number %}empty{% endif %}">
                {{ entry.hardware_serial_number|default:"Not specified" }}
              </div>
            </div>
            <div class="detail-item">
              <div class="detail-label">Computer Name</div>
              <div class="detail-value {% if not entry.computer_name %}empty{% endif %}">
                {{ entry.computer_name|default:"Not specified" }}
              </div>
            </div>
          </div>
        </div>
        {% endif %}

        {% if entry.application_description or entry.application_version %}
        <div class="modern-card">
          <div class="card-header-modern">
            <h2 class="card-title-modern"><i class="fas fa-desktop mr-2"></i>Application System / Software</h2>
          </div>

          <div class="detail-grid">
            <div class="detail-item">
              <div class="detail-label">Description</div>
              <div class="detail-value {% if not entry.application_description %}empty{% endif %}">
                {{ entry.application_description|default:"Not specified" }}
              </div>
            </div>
            <div class="detail-item">
              <div class="detail-label">Version</div>
              <div class="detail-value {% if not entry.application_version %}empty{% endif %}">
                {{ entry.application_version|default:"Not specified" }}
              </div>
            </div>
          </div>
        </div>
        {% endif %}

        {% if entry.connectivity_description %}
        <div class="modern-card">
          <div class="card-header-modern">
            <h2 class="card-title-modern"><i class="fas fa-network-wired mr-2"></i>Connectivity</h2>
          </div>

          <div style="padding: 1.5rem;">
            <div class="detail-item">
              <div class="detail-label">Description</div>
              <div class="detail-value">{{ entry.connectivity_description }}</div>
            </div>
          </div>
        </div>
        {% endif %}

        {% if entry.user_account_description %}
        <div class="modern-card">
          <div class="card-header-modern">
            <h2 class="card-title-modern"><i class="fas fa-user-lock mr-2"></i>User Account</h2>
          </div>

          <div style="padding: 1.5rem;">
            <div class="detail-item">
              <div class="detail-label">Description</div>
              <div class="detail-value">{{ entry.user_account_description }}</div>
            </div>
          </div>
        </div>
        {% endif %}
      </div>
      {% endif %}

      <!-- Assessment Tab -->
      {% if entry.assessment or entry.resolution %}
      <div class="tab-pane fade" id="pills-assessment" role="tabpanel">
        {% if entry.assessment %}
        <div class="modern-card">
          <div class="card-header-modern">
            <h2 class="card-title-modern"><i class="fas fa-clipboard-check mr-2"></i>Technical Assessment</h2>
          </div>

          <div style="padding: 1.5rem;">
            <div class="detail-item">
              <div class="detail-value">{{ entry.assessment }}</div>
            </div>
          </div>
        </div>
        {% endif %}

        <div class="modern-card">
          <div class="card-header-modern">
            <h2 class="card-title-modern"><i class="fas fa-check-circle mr-2"></i>Actions Taken and/or Recommendations</h2>
          </div>

          <div style="padding: 1.5rem;">
            <div class="detail-item">
              <div class="detail-value {% if not entry.resolution %}empty{% endif %}">
                {{ entry.resolution|default:"No actions recorded" }}
              </div>
            </div>
          </div>
        </div>
      </div>
      {% endif %}

      <!-- Client Evaluation Tab -->
      {% if entry.concern_addressed or entry.satisfaction_service or entry.satisfaction_solution or entry.client_comments %}
      <div class="tab-pane fade" id="pills-evaluation" role="tabpanel">
        <div class="modern-card">
          <div class="card-header-modern">
            <h2 class="card-title-modern"><i class="fas fa-star mr-2"></i>Client's Evaluation</h2>
          </div>

          <div style="padding: 1.5rem;">
            {% if entry.concern_addressed %}
            <div class="detail-item mb-3">
              <div class="detail-label">1. Was your concern/problem properly addressed?</div>
              <div class="detail-value">
                <span class="evaluation-badge">{{ entry.concern_addressed }}</span>
              </div>
            </div>
            {% endif %}

            {% if entry.satisfaction_service %}
            <div class="detail-item mb-3">
              <div class="detail-label">2. How satisfied are you with the I.T. support service received?</div>
              <div class="detail-value">
                <span class="evaluation-badge">{{ entry.satisfaction_service }}</span>
              </div>
            </div>
            {% endif %}

            {% if entry.satisfaction_solution %}
            <div class="detail-item mb-3">
              <div class="detail-label">3. How satisfied are you with the effectiveness of the solution?</div>
              <div class="detail-value">
                <span class="evaluation-badge">{{ entry.satisfaction_solution }}</span>
              </div>
            </div>
            {% endif %}

            {% if entry.client_comments %}
            <div class="detail-item">
              <div class="detail-label">Comments and/or Suggestions</div>
              <div class="detail-value">{{ entry.client_comments }}</div>
            </div>
            {% endif %}
          </div>
        </div>
      </div>
      {% endif %}

    </div>

  </div>
</div>
{% endblock %}
